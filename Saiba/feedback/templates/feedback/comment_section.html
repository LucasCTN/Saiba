<section id="comentarios" class="container col-md-12">
    <hr/>            
    <h2>Comentários</h2>

    <iframe hidden width="0" height="0" border="0" name="dummyframe" id="dummyframe"></iframe>

    <!--<form id="comment-form" method="post" class="form-horizontal" role="form" action="{% url 'api:api_comments' %}" target="dummyframe">-->
    <form id="comment-form" method="post" class="form-horizontal" role="form" target="dummyframe">
        {% csrf_token %}
        <div class="form-group">
            <label for="content" class="control-label">Comentando como:</label>
            <textarea name="content" class="form-control" id="post_content" rows="3"></textarea>
        </div>
        <input type="hidden" name="type" value="{{type}}" />
        <input type="hidden" name="slug" value="{{entry.slug}}" />
        <button type="submit" class="btn btn-primary col-md-1" id="post-comment">Enviar</button>
    </form>

    <br/><br/><br/>

    <div id="comment-section">
    </div>

    <script>
        var sendCommentApiEndpoint  = "{% url 'api:api_comments' %}";
        var getCommentApiEndpoint   = "{% url 'api:api_comment_page' %}?reply_limit=3&page=1&slug={{entry.slug}}&type={{type}}&id={{id}}";
        var sendReplyApiEndpoint  = "{% url 'api:api_replies' %}";

        $(document).ready(function () {
            updateCommentSection("#comment-section", getCommentApiEndpoint);
        });

        $('#post-comment').click(function(){

            var type    = $("[name='type']").val();
            var slug    = $("[name='slug']").val();
            var content = $("[name='content']").val();
            
            sendComment(type, slug, content, sendCommentApiEndpoint, getCommentApiEndpoint);
        });
    </script>
</section>